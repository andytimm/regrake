% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/parse_raking_formula.R
\name{parse_raking_formula}
\alias{parse_raking_formula}
\title{Parse a raking formula}
\usage{
parse_raking_formula(formula)
}
\arguments{
\item{formula}{A formula specifying raking constraints (e.g., ~ race + l2(age:educ))}
}
\value{
A list containing:
\item{terms}{List of parsed terms, each with type and variables}
\item{variables}{Character vector of all required variables}
\item{interactions}{List of interaction specifications}
\item{formula}{The original formula object}
}
\description{
Parses a formula that specifies raking constraints. The formula interface provides
a natural R-like syntax for specifying both main effects and interactions, with
optional constraint types for each term.
}
\details{
The formula interface supports:
\itemize{
\item Main effects: \code{~ age + race}
\item N-way interactions: \code{~ age:race}, \code{~ age:race:education}
\item Constraint types: \code{rr_exact()}, \code{rr_l2()}, \code{rr_kl()}
\item Mixed constraints: \code{~ age + rr_l2(age:race)}
}

For categorical variables:
\itemize{
\item All levels are preserved (no reference level encoding)
\item This matches typical raking interfaces where margins are specified for all categories
\item Supports linearly dependent constraints in the underlying solver
}

When variables appear in both main effects and interactions:
\itemize{
\item Main effects use exact constraints by default
\item Interactions can use any constraint type (exact, l2, kl)
\item A warning is issued to clarify the behavior
\item Example: \code{~ age + race + rr_l2(age:race)} will use exact constraints for main effects
and l2 for the interaction
}

Pure duplicates (same variables with different constraints) are not allowed:
\itemize{
\item \code{~ age + rr_l2(age)} will error
\item \code{~ age:race + rr_l2(age:race)} will error
}
}
\keyword{internal}
